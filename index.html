<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente de Hoja Interactiva | Gemini</title>
</head>
<body>
    <div class="container">
        <h1>‚ú® Tu Contenido Cobra Vida ‚ú®</h1>
        <p>Hemos identificado tu hoja. Haz clic abajo para iniciar una conversaci√≥n con nuestro Asistente Experto Gemini. ¬°Recuerda usar la c√°mara para mostrar el papel!</p>
        
        <button id="lanzarGemini">
            ü§ñ Iniciar Conversaci√≥n con Gemini
        </button>
        
        <p class="instruccion">
            ID de la Hoja (para el Asistente): <span id="hojaDisplay">Cargando...</span>
        </p>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- INICIO: L√≥gica ultra-reforzada para leer el ID de la URL ---
            let hojaID = 'ID-NO-ENCONTRADO';
            
            // 1. Intentar leer el par√°metro 'hoja' del querystring
            const urlParams = new URLSearchParams(window.location.search);
            hojaID = urlParams.get('hoja');

            // 2. Si falla, usar fallback o valor predeterminado
            if (!hojaID || hojaID === '') {
                hojaID = 'ID-NO-ESPECIFICADO';
            }
            // --- FIN: L√≥gica de lectura de ID ---

            // Mostrar el ID en la p√°gina para verificaci√≥n
            document.getElementById('hojaDisplay').textContent = hojaID;

            // 3. Definir el Prompt (la instrucci√≥n larga para la IA)
            const promptTemplate = "Hola Gemini. El usuario que ha iniciado esta conversaci√≥n ha escaneado un c√≥digo QR desde uno de nuestros productos, una hoja interactiva con el ID √∫nico: [ID_HOJA]. Tu rol es ser el Asistente Experto Multimodal sobre el contenido que el usuario te va a mostrar. Por favor, realiza lo siguiente: 1. Recon√≥ceme: Da una bienvenida confirmando que has entendido el contexto: '¬°Hola! Soy tu Asistente Experto para la hoja [ID_HOJA]. Estoy listo para ir m√°s all√° de lo que ves en el papel.' 2. Gu√≠a al Usuario: Instruye al usuario de forma clara sobre c√≥mo usar la c√°mara para que te muestre la hoja: 'Por favor, usa el bot√≥n de la c√°mara üì∑ y enfoca la hoja para que pueda ver el texto. Una vez que lo hagas, preg√∫ntame lo que desees sobre √©l: resumir, buscar informaci√≥n relacionada, obtener ideas o formular preguntas espec√≠ficas.' Tu objetivo es: Permitir cualquier interacci√≥n creativa que amplifique el contenido f√≠sico con la potencia de internet, sin limitarte a una sola funci√≥n.";

            // 4. Reemplazar el placeholder por el ID real y codificar la URL
            const promptFinal = promptTemplate.replace(/\[ID_HOJA\]/g, hojaID);
            const promptCodificado = encodeURIComponent(promptFinal);

            // 5. Crear la URL de destino final para Gemini
            const urlGemini = `https://gemini.google.com/chat?prompt=${promptCodificado}`;

            // 6. Asignar la acci√≥n al bot√≥n (Redirecci√≥n con permiso del usuario)
            document.getElementById('lanzarGemini').onclick = function() {
                window.location.href = urlGemini;
            };
        });
    </script>

    <style>
        /* Estilos base y Responsivos para M√≥viles */
        body {
            background-color: #f0f2f5;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            padding: 20px; 
            background-color: #ffffff; /* Fondo blanco */
            color: #333; 
            max-width: 400px; /* Limita el ancho m√°ximo */
            width: 90%; /* Ocupa la mayor parte del ancho en m√≥viles */
            margin: 0 auto;
            border-radius: 10px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
        }
        h1 { 
            color: #1a73e8; 
            font-size: 1.6em; 
            margin-bottom: 15px; 
        }
        p { 
            margin-bottom: 25px; 
            line-height: 1.5; 
            font-size: 1em;
        }
        /* Estilo del Bot√≥n */
        #lanzarGemini {
            background-color: #4285f4; 
            color: white;
            padding: 18px 25px; 
            border: none;
            border-radius: 8px; 
            font-size: 1.1em;
            width: 100%; /* Ocupa todo el ancho disponible en el contenedor */
            cursor: pointer;
            transition: background-color 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        #lanzarGemini:hover { 
            background-color: #3b78e7; 
        }
        /* Estilo de la instrucci√≥n de ID (peque√±a y discreta) */
        .instruccion { 
            margin-top: 25px; 
            font-size: 0.8em; 
            color: #666; 
            padding: 5px;
            border-top: 1px solid #eee;
        }

        /* Media Query para asegurar la est√©tica en pantallas grandes */
        @media (min-width: 600px) {
            body {
                background-color: #f0f2f5; 
            }
        }
    </style>
</body>
</html>
